<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>語音點餐系統 - 長按錄音 + Modal客製 + 按鈕稍微提高</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    /* ====== 全域樣式 ====== */
    body {
      font-family: Arial, sans-serif;
      background-color: #f7f7f7;
      color: #333;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #4a4a4a;
      color: white;
      padding: 10px 0;
      text-align: center;
    }
    main {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background-color: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      border-radius: 10px;
      position: relative;
    }
    h1, h2 {
      margin: 0 0 20px;
      font-weight: normal;
    }
    label {
      display: block;
      margin-bottom: 10px;
      font-size: 18px;
    }
    #inputTextArea {
      width: 100%;
      height: 80px;
      margin-bottom: 20px;
      border-radius: 5px;
      border: 1px solid #ccc;
      padding: 10px;
      font-size: 14px;
      resize: none;
      background-color: #f9f9f9;
    }

    /* ====== 按鈕樣式 ====== */
    button {
      font-size: 14px;
      padding: 10px 15px;
      background-color: #6c757d;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-right: 5px;
    }
    #clearInputBtn {
      background-color: #adb5bd;
    }
    #deleteBtn {
      background-color: #dc3545;
    }
    #completeOrderBtn {
      background-color: #495057;
      margin-top: 10px;
    }

    /* ====== 表格 ====== */
    #orderTable {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
      font-size: 14px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #e9ecef;
    }
    #totalPrice {
      font-weight: bold;
      font-size: 16px;
    }

    /* ====== 客製化 Modal ====== */
    #customizeModal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      align-items: center; 
      justify-content: center;
      z-index: 9999;
    }
    #modalContent {
      background: #fff;
      padding: 20px;
      border-radius: 5px;
      max-width: 300px;
      margin: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .option-btns {
      display: flex; 
      flex-wrap: wrap;
      gap: 5px; 
      margin-bottom: 10px;
    }
    .option-btn {
      background-color: #ccc;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }
    .option-btn.active {
      background-color: #6c757d;
      color: #fff;
    }
    .qty-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      gap: 5px;
    }
    #minusQtyBtn, #plusQtyBtn {
      background-color: #adb5bd;
      border: none;
      padding: 5px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }
    #qtyInput {
      width: 60px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 4px;
      font-size: 14px;
    }
    #modalBtns {
      display: flex; 
      gap: 10px;
    }
    #confirmBtn, #cancelBtn {
      background-color: #6c757d;
      color: #fff;
      border: none;
      padding: 8px 14px;
      border-radius: 5px;
      cursor: pointer;
    }
    #cancelBtn {
      background-color: #adb5bd;
    }

    /* ====== RWD 手機 ====== */
    @media (max-width: 600px) {
      main {
        margin: 10px;
        padding: 15px;
      }
      h1, h2 {
        font-size: 18px; margin-bottom: 15px;
      }
      label {
        font-size: 16px;
      }
      #inputTextArea {
        font-size: 14px;
      }
      #orderTable {
        font-size: 13px;
      }
      #totalPrice {
        font-size: 14px;
      }
      button {
        font-size: 13px; 
        padding: 8px 10px;
      }
    }

    /* ====== 長按語音按鈕 - 底部 50px ====== */
    #voiceBtn {
      position: fixed;
      bottom: 50px; /* 改為離底部50px */
      left: 50%;
      transform: translateX(-50%);
      z-index: 9999;
      font-size: 16px;
      padding: 15px 30px;
      background-color: #17a2b8;
      border-radius: 30px;
      margin-right: 0;
    }
    #voiceBtn:active {
      background-color: #138496;
    }
  </style>
</head>
<body>
  <header>
    <h1>語音點餐 - 長按錄音(按鈕向上提升)</h1>
  </header>
  <main>
    <label for="inputTextArea">點餐內容 (長按「按住說話」可錄音):</label>
    <textarea id="inputTextArea" placeholder="也可自行輸入文字…"></textarea>
    <br/>
    <!-- 其他按鈕 -->
    <button id="clearInputBtn" onclick="onClearClick()">清除點餐</button>

    <h2>餐點清單:</h2>
    <div>
      <button id="incrementBtn" onclick="onIncrementClick()">+</button>
      <button id="decrementBtn" onclick="onDecrementClick()">-</button>
      <button id="deleteBtn" onclick="onDeleteClick()">刪除</button>
      <button id="customizeBtn" onclick="onCustomizeClick()">客製</button>
    </div>

    <table id="orderTable">
      <thead>
        <tr>
          <th>選擇</th>
          <th>餐點名稱</th>
          <th>單價</th>
          <th>數量</th>
          <th>備註</th>
        </tr>
      </thead>
      <tbody id="orderTableBody"></tbody>
    </table>
    <div>總金額：<span id="totalPrice">0</span> 元</div>
    <button id="completeOrderBtn" onclick="onCompleteOrderClick()">完成訂單</button>
  </main>

  <!-- 語音輸入按鈕 (長按) -->
  <button
    id="voiceBtn"
    onmousedown="startVoiceInput()"
    onmouseup="stopVoiceInput()"
    ontouchstart="startVoiceInput()"
    ontouchend="stopVoiceInput()"
  >
    按住 說話
  </button>

  <!-- 客製化Modal (與 JS 相同) -->
  <div id="customizeModal">
    <div id="modalContent">
      <h3>客製化</h3>
      <div class="option-btns">
        <button class="option-btn" data-value="不">不</button>
        <button class="option-btn" data-value="多">多</button>
        <button class="option-btn" data-value="醋">醋</button>
        <button class="option-btn" data-value="蒜">蒜</button>
        <button class="option-btn" data-value="菜">菜</button>
      </div>
      <div class="qty-row">
        <button id="minusQtyBtn" type="button">-</button>
        <input id="qtyInput" type="number" step="1" min="0" value="0" />
        <button id="plusQtyBtn" type="button">+</button>
      </div>
      <div id="modalBtns">
        <button id="confirmBtn">確定</button>
        <button id="cancelBtn">取消</button>
      </div>
    </div>
  </div>

  <script>
    /* 與您先前的解析語音、客製邏輯、震動程式等相同。
       以下僅示範核心結構，可把之前的function全部複製進來。 */

    // 範例：震動函式
    function vibrate(duration) {
      if (navigator.vibrate) {
        navigator.vibrate(duration);
      }
    }

    // 長按語音
    let recognition = null;
    function startVoiceInput() {
      vibrate(50); // 按下時震動
      /* 其餘跟之前相同：document.getElementById("inputTextArea").value = "";
         new SpeechRecognition() => onresult =>  ...
         recognition.start(); 
      */
    }
    function stopVoiceInput() {
      /* recognition.stop(); => onend => analyzeText() */
    }

    // 其他功能: onClearClick, onIncrementClick, etc...
    // analyzeText(), parse "辣/冰/溫", merge, update table, etc...
  </script>
</body>
</html>